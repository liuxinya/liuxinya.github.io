<!DOCTYPE HTML>
<html class="no-js" lang="zh-CN">
<!--
//                            _ooOoo_
//                           o8888888o
//                           88" . "88
//                           (| -_- |)
//                            O\ = /O
//                        ____/`---'\____
//                      .   ' \\| |// `.
//                       / \\||| : |||// \
//                     / _||||| -:- |||||- \
//                       | | \\\ - /// | |
//                     | \_| ''\---/'' | |
//                      \ .-\__ `-` ___/-. /
//                   ___`. .' /--.--\ `. . __
//                ."" '< `.___\_<|>_/___.' >'"".
//               | | : `- \`.;`\ _ /`;.`/ - ` : | |
//                 \ \ `-. \_ __\ /__ _/ .-` / /
//         ======`-.____`-.___\_____/___.-`____.-'======
//                            `=---='
//                 拦截插件累计拦截逗比攻击"1381438"次！
//         .............................................
//                  佛祖保佑             永无BUG
//          佛曰:
//                  写字楼里写字间，写字间里程序员；
//                  程序人员写程序，又拿程序换酒钱。
//                  酒醒只在网上坐，酒醉还来网下眠；
//                  酒醉酒醒日复日，网上网下年复年。
//                  但愿老死电脑间，不愿鞠躬老板前；
//                  奔驰宝马贵者趣，公交自行程序员。
//                  别人笑我忒疯癫，我笑自己命太贱；
//                  不见满街漂亮妹，哪个归得程序员？
-->
<head>
    <!--[if lte IE 9]>
<meta http-equiv="refresh" content="0;url=https://liuxinya.github.io/warn.html">
<![endif]-->
<meta charset="utf-8">

<meta http-equiv="X-UA-Compatible" content="IE=Edge">
<meta name="renderer" content="webkit">
<meta name="viewport" content="width=device-width, initial-scale=1.0,user-scalable=no">
<meta http-equiv="mobile-agent" content="format=html5; url=https://liuxinya.github.io">
<meta name="author" content="John Doe">
<link rel="stylesheet" href="//netdna.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
<link rel="stylesheet" href="/css/SimpleStyle.min.css">

<link rel="shortcut icon" href="/images/favicon.png">


<title>神奇的canvas - 刘新亚的主页</title>

<meta name="keywords" content="">

<meta name="description " content="">
</head>
<body>
<div id="nav">
    <nav class="nav-menu">
        <a class="site-name current" href="/" title="刘">刘</a>
        <a class="site-index current" href="/"><i class="fa fa-home"></i><span>首页</span></a>
        <a href="/archives" title="归档"><i class="fa fa-archives"></i><span>归档</span></a>
        <a href="/tags" title="标签"><i class="fa fa-tags"></i><span>标签</span></a>
        <!-- custom single page of menus -->
        
        
        <a href="/cross_fire" title="长路漫漫">
            <i class="fa fa-wifi"></i>
            <span>长路漫漫</span>
        </a>
        
        
        <a href="/help" title="HELP">
            <i class="fa fa-question-circle"></i>
            <span>HELP</span>
        </a>
        
    </nav>
</div>

<div class="nav-user">
    <a class="btn-search" href="#"><i class="fa fa-search"></i></a>
    <a class="btn-read-mode" href="#"><i class="fa fa-sun-o"></i></a>
    <a class="btn-weixin-mp" href="javascript:"><i class="fa fa-weixin"></i></a>
</div>
<div id="wrapper" class="clearfix">
    <div id="body">
        <div class="main" id="main">
            <div id="cover">
    <div class="cover-img"></div>
    <div class="cover-info">
        
        <h1 class="cover-siteName">just do IT</h1>
        <h3 class="cover-siteTitle">一入前端深似海</h3>
        <p class="cover-siteDesc">welcome to my Blog</p>
        <div class="cover-sns">
            
            <div class="btn btn-telegram">
                <a href="https://liuxinya.github.io/" target="_blank" title="telegram" ref="friend">
                    <i class="fa fa-telegram"></i>
                </a>
            </div>
            
            <div class="btn btn-instagram">
                <a href="https://liuxinya.github.io/" target="_blank" title="instagram" ref="friend">
                    <i class="fa fa-instagram"></i>
                </a>
            </div>
            
            <div class="btn btn-twitter">
                <a href="./bird/index.html" target="_blank" title="twitter" ref="friend">
                    <i class="fa fa-twitter"></i>
                </a>
            </div>
            
            <div class="btn btn-github">
                <a href="https://liuxinya.github.io/" target="_blank" title="github" ref="friend">
                    <i class="fa fa-github"></i>
                </a>
            </div>
            
        </div>
    </div>
</div>
            <div class="page-title">
    <ul>
        <li><a href="/">最新</a></li>
        
        
        
        <li class="page-search">
    <form id="search" class="search-form">
        <label for="s" class="sr-only">请输入关键字</label>
        <input class="search-field" type="text" name="s" class="text" placeholder="请输入关键字" />
        <button type="submit" class="search-form-submit" title="搜索"><i class="fa fa-search"></i></button>
    </form>
    <div class="ins-search">
    <div class="ins-search-mask"></div>
    <div class="ins-search-container">
        <div class="ins-input-wrapper">
            <input type="text" class="ins-search-input" placeholder="请输入关键词..."/>
            <span class="ins-close ins-selectable"><i class="fa fa-times-circle"></i></span>
        </div>
        <div class="ins-section-wrapper">
            <div class="ins-section-container"></div>
        </div>
    </div>
</div>
<script>
(function (window) {
    var INSIGHT_CONFIG = {
        TRANSLATION: {
            POSTS: '文章',
            PAGES: '页面',
            CATEGORIES: '分类',
            TAGS: '标签',
            UNTITLED: '(无标题)',
        },
        ROOT_URL: '/',
        CONTENT_URL: '/content.json',
    };
    window.INSIGHT_CONFIG = INSIGHT_CONFIG;
})(window);
</script>
</li>

    </ul>
</div>
<div class="main-inner">
    <article class="post" itemscope itemtype="http://schema.org/BlogPosting">
        <div class="post-header">
            <div class="post-author clearfix">
                <a class="avatar fleft" href="" target="_blank">
                    <img width="48" src="" alt="avatar"/>
                </a>
                <p><span class="label">作者</span>
                    <a href="" target="_blank"></a>
                    <span title="最后编辑于2017-10-08">2017-10-08</span>
                </p>
                <p></p>
            </div>
            <h2 class="post-title">神奇的canvas</h2>
            <div class="post-meta">
                本文总共25940个字 | 您是第<span id="busuanzi_value_page_pv"><i class="fa fa-spinner fa-spin"></i></span>位看到它们的小伙伴
            </div>
        </div>
        <div class="post-content markdown-body">
            <p>#神奇的canvas</p>
<h1 id="一、canvas简介"><a href="#一、canvas简介" class="headerlink" title="一、canvas简介"></a>一、canvas简介</h1><h2 id="1-1-什么是canvas？（了解）"><a href="#1-1-什么是canvas？（了解）" class="headerlink" title="1.1 什么是canvas？（了解）"></a>1.1 什么是canvas？（了解）</h2><ul>
<li><p>是HTML5提供的一种新标签</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">&lt;canvas&gt;&lt;/canvas&gt;</div><div class="line"> 英 [&apos;kænvəs]  美 [&apos;kænvəs]   帆布 画布</div></pre></td></tr></table></figure>
</li>
<li><p>Canvas是一个矩形区域的画布，可以用JavaScript在上面绘画。控制其每一个像素。</p>
</li>
<li>canvas 标签使用 JavaScript 在网页上绘制图像，本身不具备绘图功能。</li>
<li>canvas 拥有多种绘制路径、矩形、圆形、字符以及添加图像的方法。</li>
<li>HTML5之前的web页面只能用一些固定样式的标签：比如p、div、h1等</li>
</ul>
<h2 id="1-2-canvas主要应用的领域（了解）"><a href="#1-2-canvas主要应用的领域（了解）" class="headerlink" title="1.2 canvas主要应用的领域（了解）"></a>1.2 canvas主要应用的领域（了解）</h2><ol>
<li><p>游戏：canvas在基于Web的图像显示方面比Flash更加立体、更加精巧，canvas游戏在流畅度和跨平台方面更牛。<br> <a href="http://www.oschina.net/news/20143/top-25-best-html5-canvas-games-you-love-to-play" target="_blank" rel="external">25 超棒的 HTML5 Canvas 游戏</a></p>
</li>
<li><p><strong>可视化数据</strong>.数据图表话，比如:<a href="http://echarts.baidu.com/" target="_blank" rel="external">百度的echart</a>    </p>
</li>
<li><p><strong>banner广告</strong>：Flash曾经辉煌的时代，智能手机还未曾出现。现在以及未来的智能机时代，HTML5技术能够在banner广告上发挥巨大作用，用Canvas实现动态的广告效果再合适不过。</p>
</li>
<li><p>未来=&gt; 模拟器：无论从视觉效果还是核心功能方面来说，模拟器产品可以完全由JavaScript来实现。</p>
</li>
<li><p>未来=&gt; 远程计算机控制：Canvas可以让开发者更好地实现基于Web的数据传输，构建一个完美的可视化控制界面。</p>
</li>
<li><p>未来=&gt; 图形编辑器：Photoshop图形编辑器将能够100%基于Web实现。</p>
</li>
<li><p>其他可嵌入网站的内容(多用于活动页面、特效)：类似图表、音频、视频，还有许多元素能够更好地与Web融合，并且不需要任何插件。</p>
</li>
<li><p><strong>完整的canvas移动化应用</strong></p>
</li>
<li><p>我们课程的目标</p>
<ul>
<li>我们不是主要做游戏开发的</li>
<li>要求必须会做基本的用canvas绘制的特效页面：比如，传智前端官网。</li>
<li>会用canvas做一些简单的广告、活动页面</li>
</ul>
</li>
<li><p>我们课程的案例和项目演示</p>
</li>
<li><p>canvas的标准： </p>
<ul>
<li>最新标准：<a href="http://www.w3.org/TR/2dcontext/" target="_blank" rel="external">http://www.w3.org/TR/2dcontext/</a></li>
<li>稳定版本的标准：<a href="http://www.w3.org/TR/2013/CR-2dcontext-20130806/" target="_blank" rel="external">http://www.w3.org/TR/2013/CR-2dcontext-20130806/</a></li>
<li>目前来说，标准还在完善中。先用早期的api足够完成所有的应用<h1 id="二、canvas绘图基础"><a href="#二、canvas绘图基础" class="headerlink" title="二、canvas绘图基础"></a>二、canvas绘图基础</h1></li>
</ul>
</li>
</ol>
<h2 id="2-0-sublime配置canvas插件（推荐）"><a href="#2-0-sublime配置canvas插件（推荐）" class="headerlink" title="2.0 sublime配置canvas插件（推荐）"></a>2.0 sublime配置canvas插件（推荐）</h2><pre><code>推荐：
    安装插件：AndyJS2
    github地址： https://github.com/malun666/AndyJS2
    直接下载到：X:\Users\用户名\AppData\Roaming\Sublime Text 3\Packages
</code></pre><h2 id="2-1-Canvas标签"><a href="#2-1-Canvas标签" class="headerlink" title="2.1 Canvas标签"></a>2.1 Canvas标签</h2><h3 id="2-1-1-canvas标签语法和属性-（重点）"><a href="#2-1-1-canvas标签语法和属性-（重点）" class="headerlink" title="2.1.1 canvas标签语法和属性  （重点）"></a>2.1.1 canvas标签语法和属性  （重点）</h3><ul>
<li>canvas：画布油布的意思 ==英 [‘kænvəs]   美 [‘kænvəs] ==</li>
<li>标签名canvas，需要进行闭合。就是一普通的html标签。</li>
<li>可以设置width和height属性，但是属性值<strong>单位必须是px</strong>，否则忽略。</li>
<li>width和hegiht：默认300*150像素</li>
<li>注意：<ul>
<li>不要用CSS控制它的宽和高,会走出图片拉伸，</li>
<li>重新设置canvas标签的宽高属性会让画布擦除所有的内容。</li>
<li>可以给canvas画布设置背景色</li>
</ul>
</li>
</ul>
<h3 id="2-1-2-浏览器不兼容处理（重点）"><a href="#2-1-2-浏览器不兼容处理（重点）" class="headerlink" title="2.1.2 浏览器不兼容处理（重点）"></a>2.1.2 浏览器不兼容处理（重点）</h3><ul>
<li>ie9以上才支持canvas, 其他chrome、ff、苹果浏览器等都支持</li>
<li>只要浏览器兼容canvas，那么就会支持绝大部分api(个别最新api除外)</li>
<li>移动端的兼容情况非常理想，基本上随便使用</li>
<li>2d的支持的都非常好，3d（webgl）ie11才支持，其他都支持</li>
<li><p>如果浏览器不兼容，最好进行友好提示         </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">例如：                     </div><div class="line">&lt;canvas id=&quot;cavsElem&quot;&gt;</div><div class="line">    你的浏览器不支持canvas，请升级浏览器.浏览器不支持，显示此行文本</div><div class="line">&lt;/canvas&gt;</div></pre></td></tr></table></figure>
</li>
<li><p>浏览器不兼容，可以使用<em>flash</em>等手段进行<strong>优雅降级</strong></p>
</li>
</ul>
<h2 id="2-2-canvas绘图上下文context"><a href="#2-2-canvas绘图上下文context" class="headerlink" title="2.2 canvas绘图上下文context"></a>2.2 canvas绘图上下文context</h2><h3 id="2-2-1-Context：Canvas的上下文、绘制环境。（重点掌握）"><a href="#2-2-1-Context：Canvas的上下文、绘制环境。（重点掌握）" class="headerlink" title="2.2.1 Context：Canvas的上下文、绘制环境。（重点掌握）"></a>2.2.1 Context：Canvas的上下文、绘制环境。（重点掌握）</h3><ul>
<li>上下文：上知天文，下知地理。是所有的绘制操作api的入口或者集合。</li>
<li>Canvas自身无法绘制任何内容。Canvas的绘图是使用JavaScript操作的。</li>
<li>Context对象就是JavaScript操作Canvas的接口。<br>*使用[CanvasElement].getContext(‘2d’)来获取2D绘图上下文。        <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">var canvas  = document.getElementById( &apos;cavsElem&apos; ); //获得画布</div><div class="line">var ctx = canvas.getContext( &apos;2d&apos; );//注意：2d小写， 3d：webgl</div></pre></td></tr></table></figure>
</li>
</ul>
<h2 id="2-3-基本的绘制路径（重点）"><a href="#2-3-基本的绘制路径（重点）" class="headerlink" title="2.3 基本的绘制路径（重点）"></a>2.3 基本的绘制路径（重点）</h2><h3 id="2-3-1-canvas坐标系"><a href="#2-3-1-canvas坐标系" class="headerlink" title="2.3.1 canvas坐标系"></a>2.3.1 canvas坐标系</h3><pre><code>canvas坐标系，从最左上角0,0开始。x向右增大， y向下增大
</code></pre><p><img src="imgs/canvas-x-y.png" height="532" width="730"></p>
<h3 id="2-3-2-设置绘制起点-moveTo"><a href="#2-3-2-设置绘制起点-moveTo" class="headerlink" title="2.3.2 设置绘制起点(moveTo)"></a>2.3.2 设置绘制起点(moveTo)</h3><pre><code>* 语法：ctx.moveTo(x, y); 
* 解释：设置上下文绘制路径的起点。相当于移动画笔到某个位置
* 参数：x,y 都是相对于 canvas盒子的最左上角。
* 注意：**绘制线段前必须先设置起点。**
</code></pre><h3 id="2-3-3-绘制直线-lineTo"><a href="#2-3-3-绘制直线-lineTo" class="headerlink" title="2.3.3 绘制直线(lineTo)"></a>2.3.3 绘制直线(lineTo)</h3><pre><code>* 语法：ctx.lineTo(x, y);
* 解释：从x,y的位置绘制一条直线到起点或者上一个线头点。
* 参数：x,y 线头点坐标。
</code></pre><h3 id="2-3-4-路径开始和闭合"><a href="#2-3-4-路径开始和闭合" class="headerlink" title="2.3.4 路径开始和闭合"></a>2.3.4 路径开始和闭合</h3><pre><code>* 开始路径：ctx.beginPath();
* 闭合路径：ctx.closePath();
* 解释：如果是绘制不同状态的线段或者形状，必须使用开始新路径的方法把不同的绘制操作隔开。闭合路径会自动把最后的线头和开始的线头连在一起。
* beginPath: 核心的作用是将 不同绘制的形状进行隔离，
  每次执行此方法，表示重新绘制一个路径,跟之前的绘制的墨迹可以进行分开样式设置和管理。每次开始新的路径，上一次的画笔的位置会丢失，需要重新移动画笔--moveTo();
</code></pre><h3 id="2-3-5-描边-stroke"><a href="#2-3-5-描边-stroke" class="headerlink" title="2.3.5 描边(stroke)"></a>2.3.5 描边(stroke)</h3><pre><code>* 语法：ctx.stroke();
* 解释：根据路径绘制线。路径只是草稿，真正绘制线必须执行stroke
* stroke: （用笔等）画；轻抚；轻挪；敲击；划尾桨；划掉；（打字时）击打键盘
 英 [strəʊk]   美 [strok]
</code></pre><ul>
<li><p>canvas绘制的基本步骤：</p>
<ul>
<li>第一步：获得上下文 =&gt;canvasElem.getContext(‘2d’);</li>
<li>第二步：开始路径规划 =&gt;ctx.beginPath()</li>
<li>第三步：移动起始点 =&gt;ctx.moveTo(x, y)</li>
<li>第四步：绘制线(矩形、圆形、图片…) =&gt;ctx.lineTo(x, y)</li>
<li>第五步：闭合路径 =&gt;ctx.closePath();</li>
<li>第六步：绘制描边 =&gt;ctx.stroke();<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line">html部分：</div><div class="line">    &lt;canvas id=&quot;cavsElem&quot;&gt;</div><div class="line">        你的浏览器不支持canvas，请升级浏览器</div><div class="line">    &lt;/canvas&gt;</div><div class="line"></div><div class="line">javascript部分：</div><div class="line"></div><div class="line">//===============基本绘制api====================</div><div class="line">//获得画布</div><div class="line">var canvas = document.querySelector(&apos;#cavsElem&apos;);</div><div class="line">var ctx = canvas.getContext(&apos;2d&apos;);  //获得上下文</div><div class="line"></div><div class="line">canvas.width = 900;     //设置标签的属性宽高</div><div class="line">canvas.height = 600;    //千万不要用 canvas.style.height</div><div class="line">canvas.style.border = &quot;1px solid #000&quot;;</div><div class="line"></div><div class="line">//绘制三角形</div><div class="line">ctx.beginPath();        //开始路径</div><div class="line">ctx.moveTo(100,100);    //三角形，左顶点</div><div class="line">ctx.lineTo(300, 100);   //右顶点</div><div class="line">ctx.lineTo(300, 300);   //底部的点</div><div class="line">ctx.closePath();        //结束路径</div><div class="line">ctx.stroke();           //描边路径</div></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p>综合案例：02绘制定位表格.html</p>
</li>
<li>综合案例：03画画板.html</li>
</ul>
<h3 id="2-3-7-填充-fill"><a href="#2-3-7-填充-fill" class="headerlink" title="2.3.7 填充(fill)"></a>2.3.7 填充(fill)</h3><pre><code>* 语法：ctx.fill(); 
* 解释：填充，是将闭合的路径的内容填充具体的颜色。默认黑色。


* 注意：交叉路径的填充问题，“非零环绕原则”，顺逆时针穿插次数决定是否填充。

    以下是非0环绕原则的原理：（了解即可，非常少会用到复杂的路径）
    “非零环绕规则”是这么来判断有自我交叉情况的路径的：对于路径中的任意给定区域，从该区域内部画一条足够长的线段，
    使此线段的终点完全落在路径范围之外。
    图2-14中的那三个箭头所描述的就是上面这个步骤。
    接下来，将计数器初始化为0，
    然后，每当这条线段与路径上的直线或曲线相交时，
    就改变计数器的值。如果是与路径的顺时针部分相交，则加1，
    如果是与路径的逆时针部分相交，则减1。若计数器的最终值不是0，那么此区域就在路径里面，在调用fill()方法时，
    浏览器就会对其进行填充。
    如果最终值是0，那么此区域就不在路径内部，浏览器也就不会对其进行填充了
* 案例： 04填充矩形.html
</code></pre><p><img src="imgs/fill-0-prin.jpg" height="206" width="289"></p>
<h3 id="2-3-8-快速创建矩形rect-方法"><a href="#2-3-8-快速创建矩形rect-方法" class="headerlink" title="2.3.8 快速创建矩形rect()方法"></a>2.3.8 快速创建矩形rect()方法</h3><pre><code>* 语法：ctx.rect(x, y, width, height);
* 解释：x, y是矩形左上角坐标， width和height都是以像素计
* rect方法只是规划了矩形的路径，并没有填充和描边。
* 改造案例：04填充矩形.html
*rect: abbr. 矩形（rectangular）；收据（receipt）
</code></pre><h3 id="2-3-9-快速创建描边矩形和填充矩形"><a href="#2-3-9-快速创建描边矩形和填充矩形" class="headerlink" title="2.3.9 快速创建描边矩形和填充矩形"></a>2.3.9 快速创建描边矩形和填充矩形</h3><pre><code>* 语法： ctx.strokeRect(x, y, width, height);
    - 参数跟2.3.8相同，注意此方法绘制完路径后立即进行stroke绘制
* 语法：ctx.fillRect(x, y, width, height);
    - 参数跟2.3.8相同， 此方法执行完成后。立即对当前矩形进行fill填充。
</code></pre><h3 id="2-3-10-清除矩形-clearRect"><a href="#2-3-10-清除矩形-clearRect" class="headerlink" title="2.3.10 清除矩形(clearRect)"></a>2.3.10 清除矩形(clearRect)</h3><pre><code>* 语法：ctx.clearRect(x, y, width, hegiht);
* 解释：清除某个矩形内的绘制的内容，相当于橡皮擦。
</code></pre><h2 id="2-4-绘制圆形（arc"><a href="#2-4-绘制圆形（arc" class="headerlink" title="2.4 绘制圆形（arc)"></a>2.4 绘制圆形（arc)</h2><ul>
<li><p>概述：arc() 方法创建弧/曲线（用于创建圆或部分圆）。</p>
<ul>
<li>语法：ctx.arc(x,y,r,sAngle,eAngle,counterclockwise);</li>
<li>arc:  弧（度）弧形物；天穹 英 [ɑːk]   美 [ɑrk]</li>
<li>counter 反击，还击；反向移动，对着干；反驳，回答  [‘kaʊntə]   美 [‘kaʊntɚ]</li>
<li>解释：<ul>
<li>x,y：圆心坐标。 </li>
<li>r：半径大小。</li>
<li>sAngle:绘制开始的角度。 圆心到最右边点是0度，顺时针方向弧度增大。</li>
<li>eAngel:结束的角度，注意是弧度。π</li>
<li>counterclockwise：是否是逆时针。true是逆时针，false：顺时针</li>
<li>弧度和角度的转换公式： rad = deg*Math.PI/180;  </li>
<li>在Math提供的方法中<strong>sin、cos等都使用的弧度</strong><br><img src="imgs/arc.gif" alt="图片" title="title3">   </li>
</ul>
</li>
</ul>
</li>
<li><p>案例：05绘制圆形.html</p>
</li>
<li>案例：06绘制饼状图.html</li>
</ul>
<h2 id="2-5-绘制文字（会使用就可以了）"><a href="#2-5-绘制文字（会使用就可以了）" class="headerlink" title="2.5 绘制文字（会使用就可以了）"></a>2.5 绘制文字（会使用就可以了）</h2><h3 id="2-5-1-绘制上下文的文字属性-（有印象就行了）"><a href="#2-5-1-绘制上下文的文字属性-（有印象就行了）" class="headerlink" title="2.5.1 绘制上下文的文字属性 （有印象就行了）"></a>2.5.1 绘制上下文的文字属性 （有印象就行了）</h3><ul>
<li><p>font            设置或返回文本内容的当前字体属性</p>
<ul>
<li>font 属性使用的语法与 CSS font 属性相同。<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">例如：ctx.font = &quot;18px &apos;微软雅黑&apos;&quot;;</div></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p>textAlign      设置或返回文本内容的当前对齐方式,该属性用于设置文字的水平对齐方式</p>
<ul>
<li>start :    默认。文本在指定的位置开始。</li>
<li>end   :    文本在指定的位置结束。</li>
<li>center:    文本的中心被放置在指定的位置。</li>
<li>left  :    文本左对齐。</li>
<li>right :    文本右对齐。      <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">* 例如：ctx.textAlign = &apos;left&apos;;</div></pre></td></tr></table></figure>
</li>
</ul>
</li>
</ul>
<p><img src="imgs/textAsign.png" alt="对齐图片"></p>
<ul>
<li>textBaseline      设置或返回在绘制文本时使用的当前文本基线,该方法设置文字在垂直方向上的对齐方式.<ul>
<li>alphabetic ：   默认。文本基线是普通的字母基线。</li>
<li>top        ：   文本基线是 em 方框的顶端。。</li>
<li>hanging    ：   文本基线是悬挂基线。</li>
<li>middle     ：   文本基线是 em 方框的正中。</li>
<li>ideographic：   文本基线是em基线。</li>
<li>bottom     ：   文本基线是 em 方框的底端。     <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">例如： ctx.textBaseline = &apos;top&apos;;</div><div class="line">单词:</div><div class="line"> alphabetic: 字母的；照字母次序的   [,ælfə&apos;bɛtɪk]</div><div class="line"> ideographic：表意的；表意字构成的   英 [,ɪdɪəʊ&apos;ɡræfɪk]   美 [,ɪdɪə&apos;græfɪk]</div></pre></td></tr></table></figure>
</li>
</ul>
</li>
</ul>
<p><img src="imgs/font-line1.png" alt="设置文字为主"><br><img src="imgs/textBaseline.gif" height="268" width="300" alt="">  </p>
<h3 id="2-5-2-上下文绘制文字方法"><a href="#2-5-2-上下文绘制文字方法" class="headerlink" title="2.5.2 上下文绘制文字方法"></a>2.5.2 上下文绘制文字方法</h3><pre><code>* ctx.fillText()      在画布上绘制“被填充的”文本
* ctx.strokeText()    在画布上绘制文本（无填充）
* ctx.measureText()   返回包含指定文本宽度的对象
* 单词：measure 测量；估量；权衡   英 [&apos;meʒə]   美 [&apos;mɛʒɚ]
</code></pre><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">//综合案例代码：</div><div class="line">ctx.moveTo( 300, 300 );</div><div class="line">ctx.fillStyle = &quot;purple&quot;;               //设置填充颜色为紫色</div><div class="line">ctx.font = &apos;20px &quot;微软雅黑&quot;&apos;;           //设置字体</div><div class="line">ctx.textBaseline = &quot;bottom&quot;;            //设置字体底线对齐绘制基线</div><div class="line">ctx.textAlign = &quot;left&quot;;                 //设置字体对齐的方式</div><div class="line">//ctx.strokeText( &quot;left&quot;, 450, 400 );</div><div class="line">ctx.fillText( &quot;Top-g&quot;, 100, 300 );        //填充文字</div></pre></td></tr></table></figure>
<h3 id="2-5-3-案例07文字绘制-html"><a href="#2-5-3-案例07文字绘制-html" class="headerlink" title="2.5.3 案例07文字绘制.html"></a>2.5.3 案例07文字绘制.html</h3><hr>
<h2 id="2-6-绘制图片（drawImage）-（重点）"><a href="#2-6-绘制图片（drawImage）-（重点）" class="headerlink" title="2.6 绘制图片（drawImage）  （重点）"></a>2.6 绘制图片（drawImage）  （重点）</h2><h3 id="2-6-1-基本绘制图片的方式"><a href="#2-6-1-基本绘制图片的方式" class="headerlink" title="2.6.1 基本绘制图片的方式"></a>2.6.1 基本绘制图片的方式</h3><pre><code>context.drawImage(img,x,y);
参数说明： x,y 绘制图片左上角的坐标， img是绘制图片的dom对象。
</code></pre><h3 id="2-6-2-在画布上绘制图像，并规定图像的宽度和高度"><a href="#2-6-2-在画布上绘制图像，并规定图像的宽度和高度" class="headerlink" title="2.6.2 在画布上绘制图像，并规定图像的宽度和高度"></a>2.6.2 在画布上绘制图像，并规定图像的宽度和高度</h3><pre><code>context.drawImage(img,x,y,width,height);   
参数说明：width 绘制图片的宽度，  height：绘制图片的高度
如果指定宽高，最好成比例，不然图片会被拉伸&lt;/em&gt;
    等比公式：  toH = Height * toW   /  Width;  //等比 
             设置高 = 原高度 * 设置宽/ 原宽度;
</code></pre><h3 id="2-6-3-图片裁剪，并在画布上定位被剪切的部分"><a href="#2-6-3-图片裁剪，并在画布上定位被剪切的部分" class="headerlink" title="2.6.3 图片裁剪，并在画布上定位被剪切的部分"></a>2.6.3 图片裁剪，并在画布上定位被剪切的部分</h3><pre><code>context.drawImage(img,sx,sy,swidth,sheight,x,y,width,height);
参数说明：
    sx,sy 裁剪的左上角坐标，
    swidth：裁剪图片的高度。 sheight:裁剪的高度 
    其他同上
</code></pre><h3 id="2-6-4-用JavaScript创建img对象"><a href="#2-6-4-用JavaScript创建img对象" class="headerlink" title="2.6.4 用JavaScript创建img对象"></a>2.6.4 用JavaScript创建img对象</h3><pre><code>第一种方式： 
   var img = document.getElementById(&quot;imgId&quot;);
第二种方式：
    var img = new Image();//这个就是 img标签的dom对象
    img.src = &quot;imgs/arc.gif&quot;;
    img.alt = &quot;文本信息&quot;;
    img.onload = function() {
        //图片加载完成后，执行此方法
    }
</code></pre><h3 id="2-6-5-面向对象基础复习补充："><a href="#2-6-5-面向对象基础复习补充：" class="headerlink" title="2.6.5 面向对象基础复习补充："></a>2.6.5 面向对象基础复习补充：</h3><ul>
<li><p>创建对象的方式：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">* var o = &#123; name: &apos;123&apos;, age: 18 &#125;; //json方式创建</div><div class="line">* var o = new Object();  //通过new的方式创建</div><div class="line">* var o = new Persion(); //通过类的构造函数创建</div></pre></td></tr></table></figure>
</li>
<li><p>JS中对象的属性创建方式</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">* json的方式： var o = &#123; age: 19 &#125;;</div><div class="line">* 直接添加属性：var o = &#123;&#125;;  o.age = 19;//太分散了，不利于管理</div><div class="line">* 由于js动态语言的特性，如果属性不存在的时候，直接添加属性。</div><div class="line">* 构造函数添加属性</div><div class="line">* 原型添加公共的属性</div></pre></td></tr></table></figure>
</li>
<li><p>JS的构造函数的原型<br>  构造函数的原型就是：构造对象的模板，构造函数原型里面的所有的属性和方法都会共享给所有的 构造函数构造出来的所有实例。<br><img src="imgs/prototype.png" height="763" width="872" alt=""></p>
</li>
<li><p>案例： 08绘制图片.html</p>
</li>
<li>案例： 09绘制图片裁剪.html</li>
<li>案例： 10序列帧动画.html</li>
<li>案例： 11面向对象版本的动画帧.html  <strong>重点</strong></li>
</ul>
<h2 id="2-6-6-补充-sublime制作代码段（推荐–已结讲过了）"><a href="#2-6-6-补充-sublime制作代码段（推荐–已结讲过了）" class="headerlink" title="2.6.6 补充 sublime制作代码段（推荐–已结讲过了）"></a>2.6.6 补充 sublime制作代码段（推荐–已结讲过了）</h2><p>第一步：sublime菜单栏→ 工具 → 制作代码段 </p>
<p>第二步：修改输出的sublime代码段文本</p>
<pre><code>&lt;snippet&gt;
    &lt;content&gt;&lt;![CDATA[
1、这里放要tab键 输出的内容
2、 ${1:this} 占位符，tab可以进行切换，数字是切换的索引。
    ：后面的是默认的文本。
]]&gt;&lt;/content&gt;
    &lt;!-- Optional: Set a tabTrigger to define how to trigger the snippet --&gt;
    &lt;tabTrigger&gt;简写的字母&lt;/tabTrigger&gt;
    &lt;!-- Optional: Set a scope to limit where the snippet will trigger --&gt;
    &lt;!-- &lt;scope&gt;source.python&lt;/scope&gt; --&gt;
&lt;/snippet&gt;
</code></pre><p>第三步：保存到插件的文件夹中，后缀名为：.sublime-snippet<br>比如我存放的位置：<br> C:\Users\malunmac\AppData\Roaming\Sublime Text 3\Packages\User\snippets<br><strong>snippets是我自己新建的文件夹。</strong></p>
<hr>
<h1 id="三、-canvas进阶"><a href="#三、-canvas进阶" class="headerlink" title="三、 canvas进阶"></a>三、 canvas进阶</h1><h2 id="3-1-Canvas颜色样式和阴影"><a href="#3-1-Canvas颜色样式和阴影" class="headerlink" title="3.1 Canvas颜色样式和阴影"></a>3.1 Canvas颜色样式和阴影</h2><h3 id="3-1-1-设置填充和描边的颜色（掌握）"><a href="#3-1-1-设置填充和描边的颜色（掌握）" class="headerlink" title="3.1.1 设置填充和描边的颜色（掌握）"></a>3.1.1 设置填充和描边的颜色（掌握）</h3><ul>
<li>fillStyle  : 设置或返回用于填充绘画的颜色</li>
<li>strokeStyle: 设置或返回用于笔触的颜色</li>
</ul>
<p>以上两个值都可以接受颜色名,16进制数据，rgb值，甚至rgba.<br>一般先进行设置样式然后进行绘制。</p>
<pre><code>例如：
ctx.strokeStyle = &quot;red&quot;;      
ctx.strokeStyle = &quot;#ccc&quot;;      
ctx.strokeStyle = &quot;rgb(255,0,0)&quot;;      
ctx.strokeStyle = &quot;rgba(255,0,0,6)&quot;;    
</code></pre><h3 id="3-1-2-设置阴影（了解，少用，性能差）"><a href="#3-1-2-设置阴影（了解，少用，性能差）" class="headerlink" title="3.1.2 设置阴影（了解，少用，性能差）"></a>3.1.2 设置阴影（了解，少用，性能差）</h3><ul>
<li>类比于CSS3的阴影。</li>
<li>shadowColor  ：   设置或返回用于阴影的颜色</li>
<li>shadowBlur   ：   设置或返回用于阴影的模糊级别,大于1的正整数，数值越高，模糊程度越大</li>
<li>shadowOffsetX：   设置或返回阴影距形状的水平距离</li>
<li>shadowOffsetY：   设置或返回阴影距形状的垂直距离</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">ctx.fillStyle = &quot;rgba(255,0,0, .9)&quot;</div><div class="line">ctx.shadowColor = &quot;teal&quot;;</div><div class="line">ctx.shadowBlur = 10;</div><div class="line">ctx.shadowOffsetX = 10;</div><div class="line">ctx.shadowOffsetY = 10;</div><div class="line">ctx.fillRect(100, 100, 100, 100);</div></pre></td></tr></table></figure>
<p>例如：</p>
<ul>
<li><p>案例： 12设置box盒子阴影.html</p>
</li>
<li><p>设置png图片的阴影，图片透明部分不会被投影。</p>
</li>
</ul>
<h2 id="3-2-复杂样式（了解）"><a href="#3-2-复杂样式（了解）" class="headerlink" title="3.2 复杂样式（了解）"></a>3.2 复杂样式（了解）</h2><h3 id="3-2-1-创建线性渐变的样式（了解）"><a href="#3-2-1-创建线性渐变的样式（了解）" class="headerlink" title="3.2.1 创建线性渐变的样式（了解）"></a>3.2.1 创建线性渐变的样式（了解）</h3><ul>
<li>一般不用，都是用图片代替，canvas绘制图片效率更高。</li>
<li>线性渐变可以用于 矩形、圆形、文字等颜色样式</li>
<li>线性渐变是一个对象</li>
<li>语法：ctx.createLinearGradient(x0,y0,x1,y1); //参数：x0,y0起始坐标，x1,y1结束坐标<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">例如：</div><div class="line">//创建线性渐变的对象，</div><div class="line">var grd=ctx.createLinearGradient(0,0,170,0);</div><div class="line">grd.addColorStop(0,&quot;black&quot;);  //添加一个渐变颜色，第一个参数介于 0.0 与 1.0 之间的值，表示渐变中开始与结束之间的位置。</div><div class="line">grd.addColorStop(1,&quot;white&quot;);  //添加一个渐变颜色</div><div class="line">ctx.fillStyle =grd;           //关键点，把渐变设置到 填充的样式</div></pre></td></tr></table></figure>
</li>
</ul>
<p>案例13设置线性渐变.html</p>
<h3 id="3-2-2-设置圆形渐变（径向渐变）-了解"><a href="#3-2-2-设置圆形渐变（径向渐变）-了解" class="headerlink" title="3.2.2 设置圆形渐变（径向渐变） 了解"></a>3.2.2 设置圆形渐变（径向渐变） 了解</h3><ul>
<li>创建放射状/圆形渐变对象。可以填充文本、形状等</li>
<li>context.createRadialGradient(x0,y0,r0,x1,y1,r1);</li>
<li>radial   半径的；放射状的；光线的；光线状的   英 [‘reɪdɪəl]   美 [‘redɪəl]</li>
<li><p>参数详解：</p>
<ul>
<li>x0:  渐变的开始圆的 x 坐标</li>
<li>y0:  渐变的开始圆的 y 坐标</li>
<li>r0:  开始圆的半径</li>
<li>x1:  渐变的结束圆的 x 坐标</li>
<li>y1:  渐变的结束圆的 y 坐标</li>
<li>r1:  结束圆的半径<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">var rlg = ctx.createRadialGradient(300,300,10,300,300,200);</div><div class="line">rlg.addColorStop(0, &apos;teal&apos;);    //添加一个渐变颜色</div><div class="line">rlg.addColorStop(.4, &apos;navy&apos;);</div><div class="line">rlg.addColorStop(1, &apos;purple&apos;);</div><div class="line">ctx.fillStyle = rlg;//设置 填充样式为延续渐变的样式</div><div class="line">ctx.fillRect(100, 100, 500, 500);</div></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p>案例14圆形渐变.html</p>
</li>
</ul>
<h3 id="3-2-3-绘制背景图（了解）"><a href="#3-2-3-绘制背景图（了解）" class="headerlink" title="3.2.3 绘制背景图（了解）"></a>3.2.3 绘制背景图（了解）</h3><ul>
<li>ctx.createPattern(img,repeat) 方法在指定的方向内重复指定的元素了解</li>
<li>pattern：n. 模式；图案；样品  英 [‘pæt(ə)n]   美 [‘pætɚn]</li>
<li><p>第一参数：设置平铺背景的图片，第二个背景平铺的方式。</p>
<ul>
<li>image    ：   规定要使用的图片、画布或视频元素。</li>
<li>repeat   ：   默认。该模式在水平和垂直方向重复。</li>
<li>repeat-x ：   该模式只在水平方向重复。</li>
<li>repeat-y ：   该模式只在垂直方向重复。</li>
<li>no-repeat：   该模式只显示一次（不重复）。<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">var ctx=c.getContext(&quot;2d&quot;);</div><div class="line">var img=document.getElementById(&quot;lamp&quot;);</div><div class="line">var pat=ctx.createPattern(img,&quot;repeat&quot;);</div><div class="line">ctx.rect(0,0,150,100);</div><div class="line">ctx.fillStyle=pat;//  把背景图设置给填充的样式</div><div class="line">ctx.fill();</div></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p>案例15背景图填充.html</p>
</li>
</ul>
<h2 id="3-3-变换（重点）"><a href="#3-3-变换（重点）" class="headerlink" title="3.3 变换（重点）"></a>3.3 变换（重点）</h2><h3 id="3-3-1-缩放（重点）"><a href="#3-3-1-缩放（重点）" class="headerlink" title="3.3.1 缩放（重点）"></a>3.3.1 缩放（重点）</h3><ul>
<li>scale() 方法缩放当前绘图，更大或更小</li>
<li>语法：context.scale(scalewidth,scaleheight)<ul>
<li>scalewidth  :  缩放当前绘图的宽度 (1=100%, 0.5=50%, 2=200%, 依次类推)</li>
<li>scaleheight :  缩放当前绘图的高度 (1=100%, 0.5=50%, 2=200%, etc.)<br>+注意1：缩放的是整个画布，缩放后，继续绘制的图形会被放大或缩小。<br>+注意2：scale(1,-1) – 这样写，X轴不变，Y坐标轴会反转</li>
</ul>
</li>
<li>案例16缩放案例.html</li>
</ul>
<h3 id="3-3-2-位移画布（重点）"><a href="#3-3-2-位移画布（重点）" class="headerlink" title="3.3.2 位移画布（重点）"></a>3.3.2 位移画布（重点）</h3><ul>
<li>ctx.translate(x,y) 方法重新映射画布上的 (0,0) 位置</li>
<li>参数说明：<ul>
<li>x：   添加到水平坐标（x）上的值</li>
<li>y：   添加到垂直坐标（y）上的值</li>
</ul>
</li>
<li>发生位移后，相当于把画布的0,0坐标 更换到新的x,y的位置，所有绘制的新元素都被影响。</li>
<li><p>位移画布一般配合缩放和旋转等。</p>
</li>
<li><p>案例： 17位移画布.html</p>
</li>
</ul>
<h3 id="3-3-3-旋转（重点）"><a href="#3-3-3-旋转（重点）" class="headerlink" title="3.3.3 旋转（重点）"></a>3.3.3 旋转（重点）</h3><ul>
<li>context.rotate(angle); 方法旋转当前的绘图</li>
<li>注意参数是弧度（PI）</li>
<li><p>如需将角度转换为弧度，请使用 degrees*Math.PI/180 公式进行计算。</p>
</li>
<li><p>案例：18旋转画布.html</p>
</li>
</ul>
<h2 id="3-3-绘制环境保存和还原（重要）"><a href="#3-3-绘制环境保存和还原（重要）" class="headerlink" title="3.3 绘制环境保存和还原（重要）"></a>3.3 绘制环境保存和还原（重要）</h2><ul>
<li>ctx.save()  保存当前环境的状态<ul>
<li>可以把当前绘制环境进行保存到缓存中。</li>
</ul>
</li>
<li>ctx.restore()   返回之前保存过的路径状态和属性<ul>
<li>获取最近缓存的ctx</li>
</ul>
</li>
<li>一般配合位移画布使用。</li>
<li>案例： 19矩形旋转案例.html</li>
</ul>
<h2 id="3-4-设置绘制环境的透明度（了解）"><a href="#3-4-设置绘制环境的透明度（了解）" class="headerlink" title="3.4 设置绘制环境的透明度（了解）"></a>3.4 设置绘制环境的透明度（了解）</h2><ul>
<li>context.globalAlpha=number;</li>
<li>number:透明值。必须介于 0.0（完全透明） 与 1.0（不透明） 之间。</li>
<li>设置透明度是全局的透明度的样式。注意是全局的。</li>
</ul>
<h2 id="3-5-画布限定区域绘制（了解）"><a href="#3-5-画布限定区域绘制（了解）" class="headerlink" title="3.5 画布限定区域绘制（了解）"></a>3.5 画布限定区域绘制（了解）</h2><ul>
<li>ctx.clip(); 方法从原始画布中剪切任意形状和尺寸</li>
<li>一旦剪切了某个区域，则所有之后的绘图都会被限制在被剪切的区域内（不能访问画布上的其他区域）</li>
<li>一般配合绘制环境的保存和还原。</li>
</ul>
<h2 id="3-6-画布保存base64编码内容（重要）"><a href="#3-6-画布保存base64编码内容（重要）" class="headerlink" title="3.6 画布保存base64编码内容（重要）"></a>3.6 画布保存base64编码内容（重要）</h2><ul>
<li>把canvas绘制的内容输出成base64内容。 </li>
<li>语法：canvas.toDataURL(type, encoderOptions);</li>
<li>例如：canvas.toDataURL(“image/jpg”,1);</li>
<li>参数说明：<ul>
<li>type，设置输出的类型，比如 image/png   image/jpeg等</li>
<li>encoderOptions： 0-1之间的数字，用于标识输出图片的质量，1表示无损压缩，类型为： image/jpeg 或者image/webp才起作用。</li>
</ul>
</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">案例1：</div><div class="line">var canvas = document.getElementById(&quot;canvas&quot;);</div><div class="line">var dataURL = canvas.toDataURL();</div><div class="line">console.log(dataURL);</div><div class="line">// &quot;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAFCAYAAACNby</div><div class="line">// blAAAADElEQVQImWNgoBMAAABpAAFEI8ARAAAAAElFTkSuQmCC&quot;</div><div class="line"></div><div class="line">var img = document.querySelector(&quot;#img-demo&quot;);//拿到图片的dom对象</div><div class="line">img.src = canvas.toDataURL(&quot;image/png&quot;);      //将画布的内容给图片标签显示</div></pre></td></tr></table></figure>
<h2 id="3-7-画布渲染画布（重要）"><a href="#3-7-画布渲染画布（重要）" class="headerlink" title="3.7 画布渲染画布（重要）"></a>3.7 画布渲染画布（重要）</h2><ul>
<li>context.drawImage(img,x,y);</li>
<li>img参数也可以是画布，也就是把一个画布整体的渲染到另外一个画布上。<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">var canvas1 = document.querySelector(&apos;#cavsElem1&apos;);</div><div class="line">var canvas2 = document.querySelector(&apos;#cavsElem2&apos;);</div><div class="line">var ctx1 = canvas1.getContext(&apos;2d&apos;);</div><div class="line">var ctx2 = canvas2.getContext(&apos;2d&apos;);</div><div class="line">ctx1.fillRect(20, 20, 40, 40);      //在第一个画布上绘制矩形</div><div class="line"></div><div class="line">ctx2.drawImage(canvas1, 10, 10);    //将第一个画布整体绘制到第二个画布上</div></pre></td></tr></table></figure>
</li>
</ul>
<h2 id="3-8-了解：线条样式（了解）"><a href="#3-8-了解：线条样式（了解）" class="headerlink" title="3.8 了解：线条样式（了解）"></a>3.8 了解：线条样式（了解）</h2><ul>
<li>lineCap     设置或返回线条的结束端点(线头、线冒)样式<ul>
<li>butt  ：  默认。向线条的每个末端添加平直的边缘。<ul>
<li>翻译.：屁股；烟头；笑柄；靶垛；粗大的一端  英 [bʌt]   美 [bʌt]</li>
</ul>
</li>
<li>round ：  向线条的每个末端添加圆形线帽。</li>
<li>square：  向线条的每个末端添加正方形线帽。<br><img src="imgs/linecap.png" height="303" width="480"><br>参考：23线的样式.html</li>
</ul>
</li>
<li><p>lineJoin    设置或返回两条线相交时，所创建的拐角类型</p>
<ul>
<li>bevel:   创建斜角。<ul>
<li>翻译. 斜角；斜面；[测] 斜角规  英 [‘bev(ə)l]   美 [‘bɛvl]</li>
</ul>
</li>
<li>round:   创建圆角。</li>
<li>miter:   默认。创建尖角<br><img src="imgs/linejoin.png" height="387" width="453" alt=""></li>
</ul>
</li>
<li><p>lineWidth   设置或返回当前的线条宽度</p>
</li>
<li>miterLimit  设置或返回最大斜接长度<ul>
<li>意思:  斜接 英 [‘maɪtə]  </li>
<li>斜接长度指的是在两条线交汇处内角和外角之间的距离。</li>
<li>一般用默认值：10就可以了。除非需要特别长的尖角时，使用此属性。<br><img src="imgs/MiterLimet.png" height="410" width="840" alt=""></li>
</ul>
</li>
<li>虚线<br>语法:<pre><code>CanvasRenderingContext2D.lineDashOffset = number
// 设置虚线的偏移
CanvasRenderingContext2D.getLineDash()
CanvasRenderingContext2D.setLineDash()
// 设置虚线的样式
</code></pre>描述:<pre><code>lineDashOffset用于设置开始绘制虚线的偏移量. 数字的正负表示左右偏移.
getLineDash() 与 setLineDash() 方法使用 数组 描述实线与虚线的长度
</code></pre></li>
</ul>
<h2 id="3-9-了解贝塞尔曲线（知道有）"><a href="#3-9-了解贝塞尔曲线（知道有）" class="headerlink" title="3.9 了解贝塞尔曲线（知道有）"></a>3.9 了解贝塞尔曲线（知道有）</h2><h3 id="3-9-1-绘制一条二次方曲线。"><a href="#3-9-1-绘制一条二次方曲线。" class="headerlink" title="3.9.1 绘制一条二次方曲线。"></a>3.9.1 绘制一条二次方曲线。</h3><ul>
<li>微软的画图板中的曲线的颜色。</li>
<li>quadratic：二次方的意思， 英 [kwɒ’drætɪk]   美 [kwɑ’drætɪk]</li>
<li>Curve：曲线的意思， 英 [kɜːv]   美 [kɝv]</li>
<li>语法： context.quadraticCurveTo(cpx,cpy,x,y);</li>
<li>参数：<ul>
<li>cpx：   贝塞尔控制点的 x 坐标</li>
<li>cpy：   贝塞尔控制点的 y 坐标</li>
<li>x  ：   结束点的 x 坐标</li>
<li>y  ：   结束点的 y 坐标<br><img src="imgs/quadraticcurve.gif" height="140" width="258" alt=""><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">ctx.beginPath();</div><div class="line">ctx.moveTo(20,20);</div><div class="line">//绘制2次方曲线，贝赛尔曲线</div><div class="line">ctx.quadraticCurveTo(20,100,200,20);</div><div class="line">ctx.stroke();</div></pre></td></tr></table></figure>
</li>
</ul>
</li>
</ul>
<h3 id="3-9-2-绘制贝塞尔曲线（知道有）"><a href="#3-9-2-绘制贝塞尔曲线（知道有）" class="headerlink" title="3.9.2 绘制贝塞尔曲线（知道有）"></a>3.9.2 绘制贝塞尔曲线（知道有）</h3><ul>
<li>绘制一条三次贝塞尔曲线</li>
<li>语法：context.bezierCurveTo(cp1x,cp1y,cp2x,cp2y,x,y);</li>
<li>提示：三次贝塞尔曲线需要三个点。前两个点是用于三次贝塞尔计算中的控制点，第三个点是曲线的结束点。曲线的开始点是当前路径中最后一个点。如果路径不存在，那么请使用 beginPath() 和 moveTo() 方法来定义开始点。</li>
<li><p>参数说明：</p>
<ul>
<li>cp1x：    第一个贝塞尔控制点的 x 坐标</li>
<li>cp1y：    第一个贝塞尔控制点的 y 坐标</li>
<li>cp2x：    第二个贝塞尔控制点的 x 坐标</li>
<li>cp2y：    第二个贝塞尔控制点的 y 坐标</li>
<li>x:        结束点的 x 坐标</li>
<li>y:        结束点的 y 坐标   <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">//绘制复杂的贝塞尔曲线</div><div class="line">ctx.beginPath();</div><div class="line">ctx.moveTo(400,400);</div><div class="line">//参数说明：context.bezierCurveTo(cp1x,cp1y,cp2x,cp2y,x,y);</div><div class="line">// cp1x： 第一个贝塞尔控制点的 x 坐标</div><div class="line">// cp1y： 第一个贝塞尔控制点的 y 坐标</div><div class="line">// cp2x： 第二个贝塞尔控制点的 x 坐标</div><div class="line">// cp2y： 第二个贝塞尔控制点的 y 坐标</div><div class="line">// x: 结束点的 x 坐标</div><div class="line">// y: 结束点的 y 坐标</div><div class="line">ctx.bezierCurveTo(500, 200, 600, 600, 700, 300);</div><div class="line">ctx.stroke();</div></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p>案例：25绘制贝塞尔曲线.html<br><img src="imgs/beziercurve.gif" height="166" width="290" alt=""></p>
</li>
</ul>
<h2 id="3-10了解创建两条切线的弧（知道有）"><a href="#3-10了解创建两条切线的弧（知道有）" class="headerlink" title="3.10了解创建两条切线的弧（知道有）"></a>3.10了解创建两条切线的弧（知道有）</h2><ul>
<li>在画布上创建介于当前起点和两个点形成的夹角的切线之间的弧</li>
<li>语法： context.arcTo(x1,y1,x2,y2,r); //类比：css3中的圆角。</li>
<li>例如： ctx.arcTo(240, 100, 240, 110, 40);</li>
<li>参数：<ul>
<li>x1:  弧的端点1的 x 坐标</li>
<li>y1:  弧的端点1的 y 坐标</li>
<li>x2:  弧的端点2(终点)的 x 坐标</li>
<li>y2:  弧的端点2(终点)的 y 坐标</li>
<li>r :  弧的半径   <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">//代码demo：</div><div class="line">ctx.beginPath();</div><div class="line">ctx.moveTo(100,100);</div><div class="line">ctx.lineTo(200,100);</div><div class="line">//context.arcTo(x1,y1,x2,y2,r); //类比：css3中的圆角。</div><div class="line">ctx.arcTo(240, 100, 240, 110, 40);</div><div class="line">ctx.lineTo(240, 300);</div><div class="line">ctx.stroke();</div></pre></td></tr></table></figure>
</li>
</ul>
</li>
</ul>
<p><img src="imgs/canvas-arcto-1.png" height="311" width="427" alt=""></p>
<h2 id="3-11了解判断点是否在路径中（知道有）"><a href="#3-11了解判断点是否在路径中（知道有）" class="headerlink" title="3.11了解判断点是否在路径中（知道有）"></a>3.11了解判断点是否在路径中（知道有）</h2><pre><code>context.isPointInPath(x,y);
//isPointInPath() 方法返回 true，如果指定的点位于当前路径中；否则返回 false。
//判断x,y坐标的点是否在当前的路径中。
</code></pre><h2 id="3-12了解文本宽度计算（知道有）"><a href="#3-12了解文本宽度计算（知道有）" class="headerlink" title="3.12了解文本宽度计算（知道有）"></a>3.12了解文本宽度计算（知道有）</h2><pre><code>context.measureText(text).width;
</code></pre><h2 id="3-13-如果以后做canvas游戏方向开发深入学习可以扩展内以下容："><a href="#3-13-如果以后做canvas游戏方向开发深入学习可以扩展内以下容：" class="headerlink" title="3.13 如果以后做canvas游戏方向开发深入学习可以扩展内以下容："></a>3.13 如果以后做canvas游戏方向开发深入学习可以扩展内以下容：</h2><ul>
<li>setTransform()  将当前转换重置为单位矩阵。然后运行 transform()</li>
<li>transform() 替换绘图的当前转换矩阵</li>
<li>globalCompositeOperation    设置或返回新图像如何绘制到已有的图像上</li>
<li>像素操作</li>
</ul>
<h1 id="四、-Canvas开发库封装"><a href="#四、-Canvas开发库封装" class="headerlink" title="四、 Canvas开发库封装"></a>四、 Canvas开发库封装</h1><h2 id="4-1封装常用的绘制函数"><a href="#4-1封装常用的绘制函数" class="headerlink" title="4.1封装常用的绘制函数"></a>4.1封装常用的绘制函数</h2><h3 id="4-1-1封装一个矩形"><a href="#4-1-1封装一个矩形" class="headerlink" title="4.1.1封装一个矩形"></a>4.1.1封装一个矩形</h3><pre><code>//思考：我们用到的矩形需要哪些绘制的东西呢？
1、矩形的 x、y坐标
2、矩形的宽高
3、矩形的边框的线条样式、线条宽度
4、矩形填充的样式
5、矩形的旋转角度
6、矩形的缩小放大
//下面是把上面所有的功能进行封装的代码：
function ItcastRect( option ) {//矩形构造函数
    this._init(option);
}
ItcastRect.prototype = {  //矩形的原型对象
    _init: function( option ) {  //初始化方法
        option = option || {};
        this.x = option.x === 0 ? 0 : option.x || 100;
        this.y = option.y === 0 ? 0 : option.y || 100;
        this.w = option.w || 100;
        this.h = option.h || 100;
        this.angle = option.angle === 0 ? 0 : option.angle || 0;
        this.fillStyle = option.fillStyle || &apos;silver&apos;;
        this.strokeStyle = option.strokeStyle || &apos;red&apos;;
        this.strokeWidth = option.strokeWidth || 4;
        this.scaleX = option.scaleX || 1;
        this.scaleY = option.Y || 1;
    },
    render: function( ctx ) {//把矩形渲染到canvas中
        ctx.save();
        ctx.translate( this.x, this.y );//位移画布
        ctx.rotate( this.angle * Math.PI / 180 );//旋转角度
        ctx.scale( this.scaleX, this.scaleY );//缩放
        ctx.fillStyle = this.fillStyle;
        ctx.fillRect( 0, 0, this.w, this.h ); //填充矩形
        ctx.lineWidth = this.strokeWidth;     //线宽
        ctx.strokeStyle = this.strokeStyle;   //填充样式
        ctx.strokeRect( 0,0,this.w,this.h );  //描边样式
        ctx.restore();
    },
    constructor: ItcastRect
};
</code></pre><h3 id="4-1-2作业：尝试着封装一个圆形？"><a href="#4-1-2作业：尝试着封装一个圆形？" class="headerlink" title="4.1.2作业：尝试着封装一个圆形？"></a>4.1.2作业：尝试着封装一个圆形？</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div></pre></td><td class="code"><pre><div class="line">//封装圆形的代码的答案：不要偷看</div><div class="line">function ItcastCircle( option ) &#123;</div><div class="line">    this._init( option );</div><div class="line">&#125;</div><div class="line">ItcastCircle.prototype = &#123;</div><div class="line">    _init: function( option ) &#123;</div><div class="line">        option = option || &#123;&#125;;</div><div class="line">        this.x = option.x === 0 ? 0 : option.x || 100;</div><div class="line">        this.y = option.y === 0 ? 0 : option.y || 100;</div><div class="line">        this.w = option.w || 100;</div><div class="line">        this.h = option.h || 100;</div><div class="line">        this.angle = option.angle === 0 ? 0 : option.angle || 0;</div><div class="line">        this.fillStyle = option.fillStyle || &apos;silver&apos;;</div><div class="line">        this.strokeStyle = option.strokeStyle || &apos;red&apos;;</div><div class="line">        this.strokeWidth = option.strokeWidth || 4;</div><div class="line">        this.scaleX = option.scaleX || 1;</div><div class="line">        this.scaleY = option.Y || 1;</div><div class="line">        this.opactity = option.opactity || 1;</div><div class="line">        this.counterclockwise = </div><div class="line">            option.counterclockwise === true ? true : option.counterclockwise || false;</div><div class="line">        this.startAngle = option.startAngle == 0 ? 0 : option.startAngle || 0;</div><div class="line">        this.endAngle = option.endAngle == 0 ? 0 : option.endAngle || 0;</div><div class="line">        this.startAngle = this.startAngle * Math.PI/180;</div><div class="line">        this.endAngle = this.endAngle * Math.PI / 180;</div><div class="line">        this.r = option.r || 100;</div><div class="line">    &#125;,</div><div class="line">    render: function( ctx ) &#123;</div><div class="line">        ctx.save();</div><div class="line">        ctx.translate( this.x, this.y);</div><div class="line">        ctx.scale( this.scaleX, this.scaleY );</div><div class="line">        ctx.rotate( this.agnle * Math.PI / 180 );</div><div class="line">        ctx.globalAlpha = this.opacity;</div><div class="line">        ctx.fillStyle = this.fillStyle;</div><div class="line">        ctx.strokeStyle = this.strokeStyle;</div><div class="line">        ctx.moveTo(0, 0);</div><div class="line">        ctx.arc( 0, 0, this.r, this.startAngle, this.endAngle, this.counterclockwise);</div><div class="line">        ctx.fill();</div><div class="line">        ctx.stroke();</div><div class="line">        ctx.restore();</div><div class="line">    &#125;,</div><div class="line">    constructor: ItcastCircle</div><div class="line">&#125;;</div></pre></td></tr></table></figure>
<h2 id="4-2-第三方库使用"><a href="#4-2-第三方库使用" class="headerlink" title="4.2 第三方库使用"></a>4.2 第三方库使用</h2><ul>
<li><p>Rgraph vs 百度的echart</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">https://roopons.com.au/wp-content/plugins/viral-optins/js/rgraph/</div></pre></td></tr></table></figure>
</li>
<li><p>国产的egret引擎</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">http://www.egret-labs.org/</div></pre></td></tr></table></figure>
</li>
<li><p>比较火的3d引擎：treejs</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">http://threejs.org/</div></pre></td></tr></table></figure>
</li>
<li><p>Konva</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">官网：http://konvajs.github.io/</div><div class="line">    特点：</div><div class="line">     * 小巧、使用方便、适合移动端和pc端</div><div class="line">     * 支持丰富的事件处理操作</div><div class="line">     * 支持类似JQuery的操作方式（顺带能复习jQueyr）</div><div class="line">     * 开源，可以随意更改</div><div class="line">     * 社区更新比较活跃，github托管源码</div><div class="line">     * 性能也不错</div></pre></td></tr></table></figure>
</li>
<li><p>其他的还有很多，希望以后能用到你们的库。</p>
</li>
</ul>
<h1 id="五、Konva的使用快速上手"><a href="#五、Konva的使用快速上手" class="headerlink" title="五、Konva的使用快速上手"></a>五、Konva的使用快速上手</h1><h2 id="5-1-Konva的整体理念"><a href="#5-1-Konva的整体理念" class="headerlink" title="5.1 Konva的整体理念"></a>5.1 Konva的整体理念</h2><ul>
<li>舞台的概念的引入。整个视图看做是一个舞台 stage</li>
<li>舞台中可以绘制很多个层 layer</li>
<li>layer下面可以有很多的group</li>
<li>group下面可以有 矩形、图片、其他形状等</li>
<li>参看：快速上手文档—查看翻译文档<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line">              Stage</div><div class="line">                |</div><div class="line">         +------+------+</div><div class="line">         |             |</div><div class="line">       Layer         Layer</div><div class="line">         |             |</div><div class="line">   +-----+-----+     Shape</div><div class="line">   |           |</div><div class="line"> Group       Group</div><div class="line">   |           |</div><div class="line">   +       +---+---+</div><div class="line">   |       |       |</div><div class="line">Shape   Group    Shape</div><div class="line">           |</div><div class="line">           +</div><div class="line">           |</div><div class="line">         Shape</div></pre></td></tr></table></figure>
</li>
</ul>
<h2 id="5-2-Konva矩形案例"><a href="#5-2-Konva矩形案例" class="headerlink" title="5.2 Konva矩形案例"></a>5.2 Konva矩形案例</h2><h3 id="5-2-1-创建一个矩形：-Konva-Rect-option"><a href="#5-2-1-创建一个矩形：-Konva-Rect-option" class="headerlink" title="5.2.1 创建一个矩形： Konva.Rect(option);"></a>5.2.1 创建一个矩形： Konva.Rect(option);</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div></pre></td><td class="code"><pre><div class="line">//Konva使用的基本案例</div><div class="line">//第一步：创建舞台</div><div class="line">var stage = new Konva.Stage(&#123;</div><div class="line">    container: &apos;container&apos;,     //需要存放舞台的Dom容器</div><div class="line">    width: window.innerWidth,   //设置全屏</div><div class="line">    height: window.innerHeight</div><div class="line">&#125;);</div><div class="line"></div><div class="line">//第二步：创建层</div><div class="line">var layer = new Konva.Layer();  //创建一个层</div><div class="line">stage.add(layer);               //把层添加到舞台</div><div class="line"></div><div class="line">//第三步： 创建矩形</div><div class="line">var rect = new Konva.Rect(&#123;     //创建一个矩形</div><div class="line">    x: 100,                     //矩形的x坐标，相对其父容器的坐标</div><div class="line">    y: 100,                      </div><div class="line">    width: 100,                 //矩形的宽度</div><div class="line">    height: 100,                //矩形高度</div><div class="line">    fill: &apos;gold&apos;,               //矩形填充的颜色</div><div class="line">    stroke: &apos;navy&apos;,             //矩形描边的颜色</div><div class="line">    strokeWidth: 4,             //填充宽度</div><div class="line">    opactity: .2,               //矩形的透明度</div><div class="line">    scale: 1.2,                 //矩形的缩放 1：原来大小</div><div class="line">    rotation: 30,               //旋转的角度，是deg不是弧度。</div><div class="line">    cornerRadius: 10,           //圆角的大小（像素） </div><div class="line">    id: &apos;rect1&apos;,                //id属性，类似dom的id属性</div><div class="line">    name: &apos;rect&apos;,</div><div class="line">    draggable: true             //是否可以进行拖拽</div><div class="line">&#125;);</div><div class="line"></div><div class="line">//创建一个组</div><div class="line">var group = new Konva.Group(&#123;</div><div class="line">    x: 40,      </div><div class="line">    y: 40,</div><div class="line">&#125;);</div><div class="line">group.add( rect );  //把矩形添加到组中</div><div class="line"></div><div class="line">//第四步： 把形状放到层中</div><div class="line">layer.add( group ); //把组添加到层中</div><div class="line">layer.draw();       //绘制层到舞台上</div></pre></td></tr></table></figure>
<h2 id="5-3-Konva的动画系统"><a href="#5-3-Konva的动画系统" class="headerlink" title="5.3 Konva的动画系统"></a>5.3 Konva的动画系统</h2><h3 id="5-3-1-tween对象-重点"><a href="#5-3-1-tween对象-重点" class="headerlink" title="5.3.1 tween对象(重点)"></a>5.3.1 tween对象(重点)</h3><ul>
<li>tween，英文意思：两者之间， 英 [twiːn]   美 [twin]</li>
<li>tween是控制Konva对象进行动画的核心对象。</li>
<li><p>tween可以控制所有数字类型的属性进行动画处理，比如：x, y, rotation,<br>width, height, radius, strokeWidth, opacity, scaleX等</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">//案例：</div><div class="line">var tween = new Konva.Tween(&#123;</div><div class="line">    node: rect,             //要进行动画的Konva对象</div><div class="line">    x: 300,                 //要进行动画的属性</div><div class="line">    opacity: .8,            </div><div class="line">    duration: 1,            //持续时间</div><div class="line">    easing: Konva.Easings.EaseIn, //动画的动画效果</div><div class="line">    yoyo: true,             //是否进行循环播放的设置</div><div class="line">    onFinish: function() &#123;</div><div class="line">        //动画执行结束后，执行此方法</div><div class="line">    &#125;</div><div class="line">&#125;);</div><div class="line"></div><div class="line">tween.play();   //启动动画</div></pre></td></tr></table></figure>
</li>
<li><p>tween的控制方法</p>
<ul>
<li>tween.play(),     //播放动画</li>
<li>tween.pause(),    //暂停动画</li>
<li>tween.reverse(),  //动画逆播放</li>
<li>tween.reset(),    //重置动画</li>
<li>tween.finish(),   //立即结束动画</li>
<li>seek：英文：寻找 英 [siːk]   美 [sik]</li>
</ul>
</li>
<li><p>tween的缓动控制选项</p>
<ul>
<li>Konva.Easings.Linear            //线性</li>
<li>Konva.Easings.EaseIn            //缓动，先慢后快</li>
<li>Konva.Easings.EaseOut //先快后慢</li>
<li>Konva.Easings.EaseInOut //两头慢，中间快</li>
<li>Konva.Easings.BackEaseIn //往回来一点，然后往前冲，汽车启动类似…</li>
<li>Konva.Easings.BackEaseOut</li>
<li>Konva.Easings.BackEaseInOut </li>
<li>Konva.Easings.ElasticEaseIn  //橡皮筋 英 [ɪ’læstɪk]   美 [ɪ’læstɪk] </li>
<li>Konva.Easings.ElasticEaseOut </li>
<li>Konva.Easings.ElasticEaseInOut </li>
<li>Konva.Easings.BounceEaseIn   //弹跳；弹起，反跳；弹回  英 [baʊns]   美 [baʊns]</li>
<li>Konva.Easings.BounceEaseOut </li>
<li>Konva.Easings.BounceEaseInOut </li>
<li>Konva.Easings.StrongEaseIn //强力</li>
<li>Konva.Easings.StrongEaseOut </li>
<li>Konva.Easings.StrongEaseInOut </li>
</ul>
</li>
<li><p>动画效果参考： 29Konva动画缓动效果案例.html</p>
</li>
</ul>
<h3 id="5-3-2-动画to的使用"><a href="#5-3-2-动画to的使用" class="headerlink" title="5.3.2 动画to的使用"></a>5.3.2 动画to的使用</h3><ul>
<li>to就是对tween的封装，比较简单好用。<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line">//案例：</div><div class="line">var rect = new Konva.Rect(&#123;</div><div class="line">    x: 10,</div><div class="line">    y: 10,</div><div class="line">    width: 100,</div><div class="line">    height: 100,</div><div class="line">    fill: &apos;red&apos;</div><div class="line">&#125;);</div><div class="line">layer.add(rect);</div><div class="line">layer.draw();</div><div class="line"></div><div class="line">//动画系统</div><div class="line">rect.to(&#123;</div><div class="line">    x: 100,</div><div class="line">    y: 100,</div><div class="line">    opactity: .1,</div><div class="line">    duration: 3,</div><div class="line">    onFinish: function() &#123;</div><div class="line"></div><div class="line">    &#125;</div><div class="line">&#125;);</div><div class="line"></div><div class="line">//to: 就是对tween的简单应用。</div></pre></td></tr></table></figure>
</li>
</ul>
<h3 id="5-3-3-Animate的应用"><a href="#5-3-3-Animate的应用" class="headerlink" title="5.3.3 Animate的应用"></a>5.3.3 Animate的应用</h3><ul>
<li>Animation动画，实际上就是浏览器通知开发者进行绘制，并提供当前的时间<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">var anim = new Konva.Animation(function(frame) &#123;</div><div class="line">    //动画系统提供的frame有三个属性可以使用：</div><div class="line">    var time = frame.time, // 动画执行的总时间</div><div class="line">        timeDiff = frame.timeDiff, // 距离上一帧的时间</div><div class="line">        frameRate = frame.frameRate; // 帧率（既1000/间隔时间）</div><div class="line">   </div><div class="line">   //动画的动作</div><div class="line"></div><div class="line">&#125;, layer);</div><div class="line"></div><div class="line">anim.start();//启动动画</div><div class="line"></div><div class="line">//anim.stop();//结束动画</div></pre></td></tr></table></figure>
</li>
</ul>
<h3 id="5-3-4-循环播放动画的实现"><a href="#5-3-4-循环播放动画的实现" class="headerlink" title="5.3.4 循环播放动画的实现"></a>5.3.4 循环播放动画的实现</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">//总体思路，使用tween 配合onFinish事件中重新播放动画，达到循环播放的效果</div><div class="line">var loopTween = new Konva.Tween(&#123;</div><div class="line">    node: star, //设置要表现动画的 Konva对象</div><div class="line">    rotation: 360,  //旋转360度</div><div class="line">    duration: 2,    //动画持续时间</div><div class="line">    easing: Konva.Easings.Linear,</div><div class="line">    onFinish: function() &#123;</div><div class="line">        // this === loopTween //true</div><div class="line">        this.reset();//重置动画</div><div class="line">        this.play(); //重新播放动画</div><div class="line">    &#125;</div><div class="line">&#125;);</div><div class="line">loopTween.play();</div></pre></td></tr></table></figure>
<h3 id="5-3-5-回放且循环播放动画"><a href="#5-3-5-回放且循环播放动画" class="headerlink" title="5.3.5 回放且循环播放动画"></a>5.3.5 回放且循环播放动画</h3><ul>
<li>yoyo属性可以进行对动画进行播放完后，回放当前动画，并持续循环来回切换播放。<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">rect.to(&#123;</div><div class="line">    duration: 2,</div><div class="line">    scale: 1.5,</div><div class="line">    yoyo: true// 此设置也可以用于 tween</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
</li>
</ul>
<h3 id="5-3-6-进度条案例"><a href="#5-3-6-进度条案例" class="headerlink" title="5.3.6 进度条案例"></a>5.3.6 进度条案例</h3><h3 id="5-3-7-传智官网案例"><a href="#5-3-7-传智官网案例" class="headerlink" title="5.3.7 传智官网案例"></a>5.3.7 传智官网案例</h3><ul>
<li>三角函数的补充<ul>
<li>Math.sin(弧度); //夹角对面的边 和 斜边的比值</li>
<li>Math.cos(弧度); //夹角侧边 与斜边的比值</li>
</ul>
</li>
<li><p>圆形上面的点的坐标的计算公式</p>
<ul>
<li>x =x0 + Math.cos(rad) * R;//x0和y0是圆心点坐标</li>
<li>y =y0 + Math.sin(rad) * R;//注意都是弧度<br><img src="imgs/圆形点的坐标计算公式.png" height="581" width="830" alt=""></li>
</ul>
</li>
<li><p>group的灵活运用</p>
<ul>
<li>konva的group很灵活，每个group都有自己的坐标系</li>
<li>group可以包含其他的group，可以对group做整个组的动画</li>
<li>group可以通过getChidren();//可以拿到直接子级元素。<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">var group = new Konva.Group(&#123;</div><div class="line">    x: 0,</div><div class="line">    y: 0</div><div class="line">&#125;);</div><div class="line">group.add(rect);</div></pre></td></tr></table></figure>
</li>
</ul>
</li>
</ul>
<h2 id="5-4-Konva的事件（重要）"><a href="#5-4-Konva的事件（重要）" class="headerlink" title="5.4 Konva的事件（重要）"></a>5.4 Konva的事件（重要）</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div></pre></td><td class="code"><pre><div class="line">var rect = new Konva.Rect(&#123;</div><div class="line">    x: 100,</div><div class="line">    y: 100,</div><div class="line">    fill: &apos;red&apos;,</div><div class="line">    width: 200,</div><div class="line">    height: 200</div><div class="line">&#125;);</div><div class="line"></div><div class="line">//绑定事件 Konva支持事件：mouseover, mouseout, mouseenter, mouseleave, mousemove, mousedown, mouseup, mousewheel, click, dblclick, dragstart, dragmove, and dragend</div><div class="line"></div><div class="line">rect.on(&apos;click&apos;, function()&#123;   //jQuery一模一样！！</div><div class="line">    console.log(&apos;^_^  ^_^&apos;);</div><div class="line">&#125;);</div><div class="line"></div><div class="line">//绑定多个事件</div><div class="line">rect.on(&apos;click mousemove&apos;,function(e)&#123;</div><div class="line"></div><div class="line">&#125;);</div><div class="line"></div><div class="line">//解除绑定事件</div><div class="line">rect.off(&apos;click&apos;);             //这不是jQuery吗？</div><div class="line"></div><div class="line">//触发事件</div><div class="line">rect.fire(&apos;click&apos;);</div><div class="line"></div><div class="line">//取消事件冒泡</div><div class="line">rect.on(&apos;click&apos;, function(evt) &#123;</div><div class="line">  alert(&apos;You clicked the circle!&apos;);</div><div class="line">  evt.cancelBubble = true;      //取消事件冒泡</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<h2 id="5-5-Konva的选择器"><a href="#5-5-Konva的选择器" class="headerlink" title="5.5 Konva的选择器"></a>5.5 Konva的选择器</h2><ul>
<li>选择方法。<ul>
<li>ID选择法：stage.find(‘#id’); //此方法返回的是一个数组</li>
<li>name选择法：group.findOne(‘.name’);//返回一个Konva对象</li>
<li>type选择法： group.find(‘Circle’);//查找所有的圆形Konva对象<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">//组中查找圆形的Konva对象</div><div class="line">groupCircle.find(&apos;Circle&apos;).each(function( circle, index )&#123;</div><div class="line">    circle.setZIndex( 3 - index );</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
</li>
</ul>
</li>
</ul>
<h3 id="5-6-饼状图案例"><a href="#5-6-饼状图案例" class="headerlink" title="5.6 饼状图案例"></a>5.6 饼状图案例</h3><ul>
<li>wedge: 楔形</li>
</ul>
<h3 id="5-7-柱状图案例"><a href="#5-7-柱状图案例" class="headerlink" title="5.7 柱状图案例"></a>5.7 柱状图案例</h3><ul>
<li>histogram n. [统计] 直方图；柱状图  英 [‘hɪstəgræm]   美 [‘hɪstəɡræm]</li>
</ul>
<h1 id="六、Canvas项目实战"><a href="#六、Canvas项目实战" class="headerlink" title="六、Canvas项目实战"></a>六、Canvas项目实战</h1><h1 id="七、Canvas优化"><a href="#七、Canvas优化" class="headerlink" title="七、Canvas优化"></a>七、Canvas优化</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div></pre></td><td class="code"><pre><div class="line"> &lt;!-- requestAnim shim layer by Paul Irish --&gt;</div><div class="line">    window.requestAnimFrame = (function()&#123;</div><div class="line">      return  window.requestAnimationFrame       || </div><div class="line">              window.webkitRequestAnimationFrame || </div><div class="line">              window.mozRequestAnimationFrame    || </div><div class="line">              window.oRequestAnimationFrame      || </div><div class="line">              window.msRequestAnimationFrame     || </div><div class="line">              function(/* function */ callback, /* DOMElement */ element)&#123;</div><div class="line">                window.setTimeout(callback, 1000 / 60);</div><div class="line">              &#125;;</div><div class="line">    &#125;)();</div><div class="line">  </div><div class="line"></div><div class="line">// example code from mr doob : http://mrdoob.com/lab/javascript/requestanimationframe/</div><div class="line"></div><div class="line">var canvas, context, toggle;</div><div class="line"></div><div class="line">init();</div><div class="line">animate();</div><div class="line"></div><div class="line">function init() &#123;</div><div class="line"></div><div class="line">    canvas = document.createElement( &apos;canvas&apos; );</div><div class="line">    canvas.width = 512;</div><div class="line">    canvas.height = 512;</div><div class="line"></div><div class="line">    context = canvas.getContext( &apos;2d&apos; );</div><div class="line"></div><div class="line">    document.body.appendChild( canvas );</div><div class="line"></div><div class="line">&#125;</div><div class="line"></div><div class="line">function animate() &#123;</div><div class="line">    requestAnimFrame( animate );</div><div class="line">    draw();</div><div class="line"></div><div class="line">&#125;</div><div class="line"></div><div class="line">function draw() &#123;</div><div class="line"></div><div class="line">    var time = new Date().getTime() * 0.002;</div><div class="line">    var x = Math.sin( time ) * 192 + 256;</div><div class="line">    var y = Math.cos( time * 0.9 ) * 192 + 256;</div><div class="line">    toggle = !toggle;</div><div class="line"></div><div class="line">    context.fillStyle = toggle ? &apos;rgb(200,200,20)&apos; :  &apos;rgb(20,20,200)&apos;;</div><div class="line">    context.beginPath();</div><div class="line">    context.arc( x, y, 10, 0, Math.PI * 2, true );</div><div class="line">    context.closePath();</div><div class="line">    context.fill();</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure>

        </div>
        <div class="post-tool">
            <a class="btn-thumbs-up" href="javascript:void(0);" data-cid="52" title="95">
                <i class="fa fa-thumbs-up" aria-hidden="true"></i> 打赏
            </a>
        </div>
        
        <div class="post-tags">标签：
            
        </div>
        
    </article>
    
    <p>本文内容仅作为作者个人兴趣与观点，不代表所在公司及团队的观点和决策。若有不恰当之处，望不吝赐教</p>
    
    
</div>
<script async src="//dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>
        </div><!-- end #main-->
    </div><!-- end #body -->
    <footer class="footer">
    <div class="footer-inner">
        <p>
            <a href="/about"  title="关于本站">关于本站</a>&nbsp;&nbsp<em>·</em>&nbsp;&nbsp
            <!-- 自定义链接 -->
            <a href="/help" title="help" >急救中心</a>&nbsp;&nbsp<em>·</em>&nbsp;&nbsp
            <a href="/links" title="友情链接">友情链接</a>&nbsp;&nbsp<em>·</em>&nbsp;&nbsp
            <a href="/app" title="App下载">App下载</a>
        </p>
        <p>
            本站点采用<a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">知识共享署名-非商业性使用-相同方式共享 4.0 国际许可协议</a>，已建立<a href="/timeline" id="siteBuildingTime"></a>天<br/>
            ©2017 基于<a href="http://hexo.io" target="_blank">Hexo</a>搭建
            ，主题&nbsp<a href="https://github.com/tangkunyin/hexo-theme-jsimple" target="_blank">JSimple</a>
            ，作者<a href="https://www.tangkunyin.com" target="_blank">唐先森</a>
            ，Hosted by <a href="https://pages.coding.me" style="font-weight: bold">Coding Pages</a>
        </p>
        
    </div>
</footer>
<script src="//cdn.bootcss.com/jquery/3.1.1/jquery.min.js"></script>
<script src="/js/InsightSearch.js"></script>
<script src="/js/SimpleCore.js"></script>

</div>
<div class="fixed-btn">
    <a class="btn-gotop" href="javascript:"> <i class="fa fa-angle-up"></i></a>
</div>
<script>
    $(function () {
        SimpleCore.init({
            buildingTime: '08/20/2014',
            current: $('.post-tags').length > 0 ? 'post' : 'archive',
            wxMpImg: '/images/weixin-mp.png',
            donateImg: '/images/donate-qr.png',
        });
    });
</script>
</body>
</html>